# エラー情報

```
ダッシュボードのデータ取得と表示について説明します：

  ダッシュボードのプロジェクトカード表示の仕組み

  1. タスク表示 (0/0の問題):
    - カードに表示される「タスク: 0/0」の値は、プロジェクトデータの completedTasks と tasks または totalTasks フィールドから取得しています
    - 修正後は ${plan.completedTasks || 0}/${plan.totalTasks || plan.tasks || 0}
  というフォーマットで表示されるようになり、どちらかのフィールドが欠けていても正常に表示されます
    - API側では各プロジェクト情報返却時に、「完了したタスク数」と「総タスク数」を計算して含めています
  2. 進捗バーの表示:
    - プロジェクトの progress 属性に基づいて表示されています
    - この値はバックエンドで計算され、タスクの完了状況に応じて更新されます
    - 進捗率に応じて色も変化します（低い進捗は赤、高い進捗は緑など）

  横断的なタスクデータ収集の仕組み

  ダッシュボードでは、プロジェクト横断的に以下のデータを集計しています：

  1. グローバル統計情報の取得 (/api/v1/projects/stats/global):
    - バックエンド実装: projectController.js の getGlobalStats 関数
    - ログインユーザーが関わる全プロジェクトのタスクを集計
    - MongoDB の countDocuments 関数を使用して、ステータス別にタスク数を集計:
        - 完了タスク (status: 'completed')
      - 進行中タスク (status: 'in_progress')
      - 未着手タスク (status: 'not_started')
    - 結果を集約して統計情報としてフロントエンドに返却
  2. 直近のタスク取得 (/api/v1/projects/tasks/upcoming):
    - バックエンド実装: projectController.js の getUpcomingTasks 関数
    - パラメーター: days (何日以内のタスクを取得するか)、limit (最大取得件数)
    - ユーザーが所属する全プロジェクトから、期限が近いタスクを抽出
    - 以下の条件に合致するタスクを取得:
        - 未完了 (status: { $ne: 'completed' })
      - 期限切れまたは期限が指定日数以内
    - 期限の早い順にソートして、指定件数まで返却
  3. アクティブなプロジェクト一覧取得 (/api/v1/projects/active):
    - 進行中または計画中のプロジェクトを取得
    - 各プロジェクトに対してタスク統計情報を追加
    - レスポンスに各プロジェクトの「完了タスク数」と「総タスク数」を含める

  これらのAPIにより、ユーザーの全プロジェクトのタスク情報を横断的に集計して表示しています。バックエンドでは MongoDB
  のクエリを使用して効率的な集計を行い、フロントエンドでは取得したデータを適切に表示しています。 戸あるんですが、http://localhost:3000/dashboardにて、カード内のタスクが0/0 統計情報は000直近の期限タスクはありません。となっていてうまく表示されていません。プロジェクトは３つあり、プロジェクト詳細ページでは未完了とか完了とか進捗とか正しくデータを拾えています。
```

# 関連ファイル

